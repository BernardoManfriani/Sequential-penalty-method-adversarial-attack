# Sequentaial penalty method adversarial attack

Implementation of the **SQUAT** Algorithm. (Th√©o Beuzeville, Alfredo Buttari, Serge Gratton, Theo Mary, Erkan Ulker. Adversarial Attacks via Sequential Quadratic Programming. 2022.)

## Prerequisites
```
$ pip install -r requirements.txt
$ pip install git+https://github.com/jeromerony/adversarial-library
```

## Train Robust SmallCNN
### Regular Training on MNIST
```bash
$ python train_regular_mnist.py \
  --batch-size 128 \
  --test-batch-size 128 \
  --epochs 20 \
  --lr 0.01 \
  --momentum 0.9 \
  --epsilon 0.3 \
  --num-steps 40 \
  --step-size 0.01 \
  --beta 1.0 \
  --seed 1 \
  --log-interval 100 \
  --model-dir 'Adversarial-attacks-via-Sequential-Quadratic-Programming\checkpoints\smallcnn_regular' \
  --save-freq 10
```

### Adversarial Training by TRADES
```bash
$ python train_trades_mnist.py \
  --batch-size 128 \
  --test-batch-size 128 \
  --epochs 20 \
  --lr 0.01 \
  --momentum 0.9 \
  --epsilon 0.3 \
  --num-steps 40 \
  --step-size 0.01 \
  --beta 1.0 \
  --seed 1 \
  --log-interval 100 \
  --model-dir 'Adversarial-attacks-via-Sequential-Quadratic-Programming\checkpoints\smallcnn_trades' \
  --save-freq 10
```

### Adversarial Training by DDN
```bash
$ python train_ddn_mnist.py \
  --batch-size 128 \
  --test-batch-size 128 \
  --epochs 20 \
  --lr 0.01 \
  --momentum 0.9 \
  --epsilon 0.3 \
  --num-steps 40 \
  --step-size 0.01 \
  --beta 1.0 \
  --seed 1 \
  --log-interval 100 \
  --model-dir 'Adversarial-attacks-via-Sequential-Quadratic-Programming\checkpoints\smallcnn_ddn' \
  --save-freq 10
```

## Attack the SmallCNN
The adversarial images generated by each attack are saved in the ./data_attack folder.
### ALMA attack
```bash
$ python .\attacks\alma_attack.py
```
### Carlini & Wagner attack
```bash
$ python .\attacks\carlini_attack.py
```
### DDN attack
```bash
$ python .\attacks\ddn_attack.py 
```
### FAB attack
```bash
$ python .\attacks\fab_attack.py
```
### SQUAT attack
```bash
$ python .\attacks\squat_attack.py
```

## Robustness Evaluation
```bash
$ python evaluate_attack_mnist.py \
--data-attack-path 'path/to/mnist_X_adv.npy'
--model-path 'path/to/model.pt',
--data-attack-path 'data_attack/mnist_X_adv.npy',
--data-path 'path/to/mnist_X.npy'
--target-path 'path/to/mnist_Y.npy',
```

## Reference
For technical details and full experimental results, please check the paper ([https://hal.archives-ouvertes.fr/hal-03752184](https://hal.archives-ouvertes.fr/hal-03752184))
